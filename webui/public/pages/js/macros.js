document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".tab-btn"),t=document.querySelectorAll(".tab-content");e.forEach(n=>{n.addEventListener("click",()=>{const s=n.getAttribute("data-tab");e.forEach(e=>e.classList.remove("active")),t.forEach(e=>e.classList.remove("active")),n.classList.add("active"),document.getElementById(`${s}Tab`).classList.add("active")})}),loadMacrosData()});async function loadMacrosData(){const e=window.location.origin;try{const t=await fetch(`${e}/api/macros/groups`);if(t.ok){const e=await t.json();renderGroups(e)}const n=await fetch(`${e}/api/macros/pinned`);if(n.ok){const e=await n.json();renderPinnedMacros(e)}const s=await fetch(`${e}/api/macros`);if(s.ok){const e=await s.json();renderMacrosList(e)}}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error loading macros data:",e)}}function renderGroups(e){const t=document.getElementById("groupsList");if(!e||e.length===0){t.innerHTML='<p class="text-muted">No groups found. Create your first group above.</p>';return}t.innerHTML=e.map(e=>`
    <div class="card mb-md">
      <div class="card-header">
        <h3 class="card-title">${e.name}</h3>
        <p class="card-subtitle">${e.macro_count||0} macros</p>
      </div>
      <div class="card-body">
        <div class="macros-in-group" data-group-id="${e.id}">
          <!-- Macros in this group will be listed here -->
        </div>
      </div>
    </div>
  `).join("")}function renderPinnedMacros(e){const t=document.getElementById("pinnedMacrosList");if(!e||e.length===0){t.innerHTML='<p class="text-muted">No pinned macros. Pin macros for quick access.</p>';return}t.innerHTML=e.map(e=>`
    <div class="card mb-md">
      <div class="card-body">
        <h3>${e.name}</h3>
        <p>${e.description||""}</p>
        <button class="btn btn-ghost btn-sm" onclick="unpinMacro('${e.id}')">Unpin</button>
      </div>
    </div>
  `).join("")}function renderMacrosList(e){const t=document.getElementById("macroSelect"),n=document.getElementById("targetGroupSelect");t.innerHTML='<option value="">Select a macro...</option>'+e.map(e=>`<option value="${e.id}">${e.name}</option>`).join("")}document.getElementById("createGroupBtn")?.addEventListener("click",async()=>{const e=document.getElementById("newGroupName").value;if(!e){alert("Please enter a group name");return}const t=window.location.origin;try{const n=await fetch(`${t}/api/macros/groups`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})});n.ok?(document.getElementById("newGroupName").value="",loadMacrosData()):alert("Failed to create group")}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error creating group:",e),alert("Error creating group")}}),document.getElementById("moveMacroBtn")?.addEventListener("click",async()=>{const e=document.getElementById("macroSelect").value,t=document.getElementById("targetGroupSelect").value;if(!e||!t){alert("Please select both macro and target group");return}const n=window.location.origin;try{const s=await fetch(`${n}/api/macros/${e}/move`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:t})});s.ok?(alert("Macro moved successfully"),loadMacrosData()):alert("Failed to move macro")}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error moving macro:",e),alert("Error moving macro")}}),document.getElementById("copyMacroBtn")?.addEventListener("click",async()=>{const e=document.getElementById("macroSelect").value,t=document.getElementById("targetGroupSelect").value;if(!e||!t){alert("Please select both macro and target group");return}const n=window.location.origin;try{const s=await fetch(`${n}/api/macros/${e}/copy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:t})});s.ok?(alert("Macro copied successfully"),loadMacrosData()):alert("Failed to copy macro")}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error copying macro:",e),alert("Error copying macro")}});async function unpinMacro(e){const t=window.location.origin;try{const n=await fetch(`${t}/api/macros/${e}/unpin`,{method:"POST"});n.ok?loadMacrosData():alert("Failed to unpin macro")}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error unpinning macro:",e),alert("Error unpinning macro")}}