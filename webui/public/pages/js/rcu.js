document.addEventListener("DOMContentLoaded",()=>{loadRCUConfig(),loadRCUStatus(),initRCUForm()});async function loadRCUConfig(){const e=window.location.origin;try{const t=await fetch(`${e}/api/rcu/config`);if(t.ok){const e=await t.json();document.getElementById("rcuEnabled").checked=e.enabled,document.getElementById("rcuPort").value=e.port||"",document.getElementById("rcuTimeout").value=e.timeout||""}}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error loading RCU config:",e)}}async function loadRCUStatus(){const t=window.location.origin,e=document.getElementById("rcuStatus");try{const n=await fetch(`${t}/api/rcu/status`);if(n.ok){const e=await n.json();renderRCUStatus(e)}else e.innerHTML='<p class="text-muted">Unable to load RCU status</p>'}catch(t){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error loading RCU status:",t),e.innerHTML='<p class="text-muted">Error loading RCU status</p>'}}function renderRCUStatus(e){const t=document.getElementById("rcuStatus");t.innerHTML=`
    <div class="form-group">
      <label class="input-label">Status</label>
      <p>${e.connected?"Connected":"Disconnected"}</p>
    </div>
    <div class="form-group">
      <label class="input-label">Last Update</label>
      <p>${e.last_update?new Date(e.last_update).toLocaleString():"Never"}</p>
    </div>
  `}function initRCUForm(){const e=document.getElementById("rcuForm"),t=document.getElementById("testRcuBtn");e.addEventListener("submit",handleSaveConfig),t.addEventListener("click",handleTestConnection)}async function handleSaveConfig(e){e.preventDefault();const t=window.location.origin,n={enabled:document.getElementById("rcuEnabled").checked,port:parseInt(document.getElementById("rcuPort").value)||8080,timeout:parseInt(document.getElementById("rcuTimeout").value)||30};try{const e=await fetch(`${t}/api/rcu/config`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});e.ok?(alert("Configuration saved successfully"),loadRCUStatus()):alert("Failed to save configuration")}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error saving RCU config:",e),alert("Error saving configuration")}}async function handleTestConnection(){const e=window.location.origin;try{const t=await fetch(`${e}/api/rcu/test`,{method:"POST"});if(t.ok){const e=await t.json();alert(e.success?"Connection test successful":"Connection test failed")}else alert("Connection test failed")}catch(e){(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.error("Error testing RCU connection:",e),alert("Error testing connection")}}